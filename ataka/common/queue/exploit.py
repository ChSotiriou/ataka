from dataclasses import dataclass
from enum import Enum

from .queue import PubSubQueue, Message


class ExploitAction(str, Enum):
    NEW = "new"
    DEACTIVATE = "deactivate"
    ACTIVATE = "activate"


@dataclass
class ExploitMessage(Message):
    action: ExploitAction
    exploit_id: str


class ExploitQueue(PubSubQueue):
    queue_name = "exploit"
    message_type = ExploitMessage
